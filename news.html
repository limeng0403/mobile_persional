<html>

<head>
    <meta name="generator" content="HTML Tidy for HTML5 (experimental) for Windows https://github.com/w3c/tidy-html5/tree/c63cc39" />
    <meta http-equiv="content-type" content="text/html;charset=utf-8" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Cache-Control" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
    <meta http-equiv="x-dns-prefetch-control" content="off" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="renderer" content="webkit" />
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
    <link href="css/amazeui.min.css" rel="stylesheet" />
    <title>新闻API</title>
</head>

<body>
    <header>
        <ul class="am-nav am-nav-pills">
            <li class="am-dropdown" data-am-dropdown>
                <a class="am-dropdown-toggle" data-am-dropdown-toggle href="javascript:;">
                    新闻分类<span class="am-icon-caret-down"></span>
                </a>
                <ul class="am-dropdown-content">
                    <li v-for="item in categoryList">
                        <a href="javascript:;" data-categoryId="{{item.channelId}}" @click="searchEvent()" v-text="item.name"></a>
                    </li>
                </ul>
            </li>
        </ul>
    </header>
    <article>
        <section>
            <ul class="am-list am-list-static am-list-border am-list-striped">
                <li v-for="item in newsList">
                    <a href="javascript:;" @click="detailEvent()" v-text="item.title"></a>
                    <section class="am-article am-hide">
                        <section class="am-article-hd">
                            <section class="am-article-title am-text-lg" v-text="item.title" style="line-height:1.5;"></section>
                            <section class="am-article-meta am-margin-top-sm am-margin-bottom-sm" v-text="item.source"></section>
                        </section>
                        <section class="am-article-bd">
                            <section class="am-article-lead am-margin-bottom-sm" v-text="item.desc"></section>
                            <section class="am-g">
                                <section class="am-u-sm-12" v-for="img in item.imageurls">
                                    <img class="am-thumbnail" src="{{img.url}}" @error="imgErrorEvent()" />
                                </section>
                            </section>
                            {{{item.html}}}
                        </section>
                    </section>
                    <span class="am-block am-text-right am-text-sm" v-text="item.pubDate"></span>
                </li>
            </ul>
        </section>
    </article>
    <span class="am-icon-chevron-circle-up am-text-xxl" style="position:fixed;bottom:20px;right:20px;" @click="returnTop()"></span>
    <script src="https://cdn.bootcss.com/jquery/2.1.4/jquery.min.js"></script>
    <script src="https://cdn.bootcss.com/vue/1.0.26/vue.min.js"></script>
    <script src="js/amazeui.min.js"></script>
    <script>
        var v = new Vue({
            el: 'body',
            data: {
                categoryList: [],
                newsList: [],
                categoryId: '0',
                searchKey: ''
            },
            ready: function() {
                $.ajax({
                    type: 'GET',
                    url: 'https://apis.baidu.com/showapi_open_bus/channel_news/channel_news',
                    headers: {
                        apikey: 'b9879e5e82c630b8de50e26b1759db30'
                    },
                    success: function(data) {
                        try {
                            var json = data;

                            if (json.showapi_res_error != '') {
                                return false;
                            }

                            v.categoryList = json.showapi_res_body.channelList;
                        } catch (e) {

                        }
                    }
                });
            },
            methods: {
                searchEvent: function() {
                    var obj = $(event.target);

                    obj.blur();
                    var categoryId = obj.attr('data-categoryId');

                    $('.am-dropdown').click();
                    $('body').scrollTop(0);

                    $.ajax({
                        type: 'GET',
                        url: 'https://apis.baidu.com/showapi_open_bus/channel_news/search_news',
                        data: $.param({
                            channelId: categoryId,
                            title: v.searchKey,
                            page: 1,
                            needContent: 0,
                            needHtml: 1
                        }),
                        headers: {
                            apikey: 'b9879e5e82c630b8de50e26b1759db30'
                        },
                        success: function(data) {
                            try {
                                var json = data;

                                if (json.showapi_res_error != '') {
                                    return false;
                                }

                                v.newsList = json.showapi_res_body.pagebean.contentlist;
                            } catch (e) {

                            }
                        }
                    });
                },
                returnTop: function() {
                    $('body').scrollTop(0);
                },
                detailEvent: function() {
                    var obj = $(event.target);

                    obj.addClass('am-hide');
                    obj.next().removeClass('am-hide');
                },
                imgErrorEvent: function() {
                    var obj = $(event.target);

                    obj.remove();
                }
            }
        });
    </script>
</body>

</html>